<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Adhearsion::VoIP::Asterisk::Manager::ManagerInterface
  
    &mdash; Documentation by YARD 0.7.2
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../../../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../../../_index.html">Index (M)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../../../Adhearsion.html" title="Adhearsion (module)">Adhearsion</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../VoIP.html" title="Adhearsion::VoIP (module)">VoIP</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Asterisk.html" title="Adhearsion::VoIP::Asterisk (module)">Asterisk</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Manager.html" title="Adhearsion::VoIP::Asterisk::Manager (module)">Manager</a></span></span>
     &raquo; 
    <span class="title">ManagerInterface</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Adhearsion::VoIP::Asterisk::Manager::ManagerInterface
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Adhearsion::VoIP::Asterisk::Manager::ManagerInterface</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/adhearsion/voip/asterisk/manager_interface.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
This class abstracts a connection to the Asterisk Manager Interface. Its
purpose is, first and foremost, to make the protocol consistent. Though the
classes employed to assist this class (ManagerInterfaceAction,
ManagerInterfaceResponse, ManagerInterfaceError, etc.) are relatively
user-friendly, they&#8217;re designed to be a building block on which to
build higher-level abstractions of the Asterisk Manager Interface.
</p>


  </div>
</div>
<div class="tags">
  
</div><h2>Defined Under Namespace</h2>
<p class="children">
   
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="ManagerInterface/AuthenticationFailedException.html" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterface::AuthenticationFailedException (class)">AuthenticationFailedException</a></span>, <span class='object_link'><a href="ManagerInterface/ManagerInterfaceAction.html" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterface::ManagerInterfaceAction (class)">ManagerInterfaceAction</a></span>, <span class='object_link'><a href="ManagerInterface/NotConnectedError.html" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterface::NotConnectedError (class)">NotConnectedError</a></span>, <span class='object_link'><a href="ManagerInterface/UnsupportedActionName.html" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterface::UnsupportedActionName (class)">UnsupportedActionName</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="CAUSAL_EVENT_NAMES-constant" class="">CAUSAL_EVENT_NAMES =
          
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='tstring_content'>queuestatus</span><span class='words_sep'> </span><span class='tstring_content'>sippeers</span><span class='words_sep'> </span><span class='tstring_content'>iaxpeers</span><span class='words_sep'> </span><span class='tstring_content'>parkedcalls</span><span class='words_sep'>
</span><span class='tstring_content'>dahdishowchannels</span><span class='words_sep'> </span><span class='tstring_content'>coreshowchannels</span><span class='words_sep'> </span><span class='tstring_content'>dbget</span><span class='words_sep'>
</span><span class='tstring_content'>status</span><span class='words_sep'> </span><span class='tstring_content'>agents</span><span class='words_sep'> </span><span class='tstring_content'>konferencelist</span><span class='words_sep'>]</span></pre></dd>
      
        <dt id="RETRY_SLEEP-constant" class="">RETRY_SLEEP =
          
        </dt>
        <dd><pre class="code"><span class='int'>5</span></pre></dd>
      
        <dt id="DEFAULT_SETTINGS-constant" class="">DEFAULT_SETTINGS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='symbol'>:host</span>           <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>localhost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='symbol'>:port</span>           <span class='op'>=&gt;</span> <span class='int'>5038</span><span class='comma'>,</span>
  <span class='symbol'>:username</span>       <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>admin</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='symbol'>:password</span>       <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>secret</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
  <span class='symbol'>:events</span>         <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbol'>:auto_reconnect</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='symbol'>:event_callback</span> <span class='op'>=&gt;</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id event'>event</span><span class='op'>|</span> <span class='const'>Events</span><span class='period'>.</span><span class='id trigger'>trigger</span><span class='lparen'>(</span><span class='qwords_beg'>%w[</span><span class='tstring_content'>asterisk</span><span class='words_sep'> </span><span class='tstring_content'>manager_interface</span><span class='words_sep'>]</span><span class='comma'>,</span> <span class='id event'>event</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='rbrace'>}</span><span class='period'>.</span><span class='id freeze'>freeze</span></pre></dd>
      
    </dl>
  





  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#causal_event_terminator_name_for-class_method" title="causal_event_terminator_name_for (class method)">+ (String) <strong>causal_event_terminator_name_for</strong>(action_name) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Used to determine the event name for an action which has causal events.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connect-class_method" title="connect (class method)">+ (Object) <strong>connect</strong>(*args) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_causal_events%3F-class_method" title="has_causal_events? (class method)">+ (String) <strong>has_causal_events?</strong>(name, headers = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
When sending an action with &#8220;causal events&#8221; (i.e. events which
must be collected to form a proper response), AMI should send a particular
event which instructs us that no more events will be sent.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#replies_with_action_id%3F-class_method" title="replies_with_action_id? (class method)">+ (Boolean) <strong>replies_with_action_id?</strong>(name, headers = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#action_error_received-instance_method" title="#action_error_received (instance method)">- (Object) <strong>action_error_received</strong>(ami_error) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#action_message_received-instance_method" title="#action_message_received (instance method)">- (Object) <strong>action_message_received</strong>(message) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#actions_connection_disconnected-instance_method" title="#actions_connection_disconnected (instance method)">- (Object) <strong>actions_connection_disconnected</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#actions_connection_established-instance_method" title="#actions_connection_established (instance method)">- (Object) <strong>actions_connection_established</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#call_and_exec-instance_method" title="#call_and_exec (instance method)">- (Object) <strong>call_and_exec</strong>(channel, app, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
call_and_exec allows you to make a call to a channel and then execute an
Astersik application on that call.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#call_into_context-instance_method" title="#call_into_context (instance method)">- (Object) <strong>call_into_context</strong>(channel, context, options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
call_into_context is syntactic sugar for the Asterisk originate command
that allows you to launch a call into a particular context.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear_actions_connection-instance_method" title="#clear_actions_connection (instance method)">- (Object) <strong>clear_actions_connection</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clear_events_connection-instance_method" title="#clear_events_connection (instance method)">- (Object) <strong>clear_events_connection</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connect%21-instance_method" title="#connect! (instance method)">- (Object) <strong>connect!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Must be called after instantiation.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#disconnect%21-instance_method" title="#disconnect! (instance method)">- (Object) <strong>disconnect!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dynamic-instance_method" title="#dynamic (instance method)">- (Object) <strong>dynamic</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#event_error_received-instance_method" title="#event_error_received (instance method)">- (Object) <strong>event_error_received</strong>(message) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#event_message_received-instance_method" title="#event_message_received (instance method)">- (Object) <strong>event_message_received</strong>(event) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Called only when this ManagerInterface is instantiated with events enabled.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#events_connection_disconnected-instance_method" title="#events_connection_disconnected (instance method)">- (Object) <strong>events_connection_disconnected</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#events_connection_established-instance_method" title="#events_connection_established (instance method)">- (Object) <strong>events_connection_established</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hangup-instance_method" title="#hangup (instance method)">- (Object) <strong>hangup</strong>(channel) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
hangup terminates a call accepts a channel as the argument full details
here: <a
href="http://www.voip-info.org/wiki/index.php?page=Asterisk+Manager+API+Action+Hangup">www.voip-info.org/wiki/index.php?page=Asterisk+Manager+API+Action+Hangup</a>.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (ManagerInterface) <strong>initialize</strong>(options = {}) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Creates a new Asterisk Manager Interface connection and exposes certain
methods to control it.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#introduce-instance_method" title="#introduce (instance method)">- (Object) <strong>introduce</strong>(caller, callee, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
An introduction connects two endpoints together.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#originate-instance_method" title="#originate (instance method)">- (Object) <strong>originate</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
The originate method launches a call to Asterisk, full details here: <a
href="http://www.voip-info.org/tiki-index.php?page=Asterisk+Manager+API+Action+Originate">www.voip-info.org/tiki-index.php?page=Asterisk+Manager+API+Action+Originate</a>
Takes these arguments as a hash:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ping-instance_method" title="#ping (instance method)">- (Object) <strong>ping</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
ping sends an action to the Asterisk Manager Interface that returns a pong
more details here: <a
href="http://www.voip-info.org/wiki/index.php?page=Asterisk+Manager+API+Action+Ping">www.voip-info.org/wiki/index.php?page=Asterisk+Manager+API+Action+Ping</a>.
</p>
</div></span>
  
</li>

      
        <li class="public deprecated">
  <span class="summary_signature">
    
      <a href="#send_action_asynchronously-instance_method" title="#send_action_asynchronously (instance method)">- (FutureResource) <strong>send_action_asynchronously</strong>(action_name, headers = {}) </a>
    

    
  </span>
  
  
  
  
  <span class="deprecated note title">Deprecated</span>
  

  
    <span class="summary_desc"><strong>Deprecated.</strong> <div class='inline'><p>
Async AMI is deprecated
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#send_action_synchronously-instance_method" title="#send_action_synchronously (instance method)">- (ManagerInterfaceResponse, ImmediateResponse) <strong>send_action_synchronously</strong>(*args) </a>
    

    
      (also: #send_action)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Sends an action over the AMI connection and blocks your Thread until the
response comes in.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#syntax_error_encountered-instance_method" title="#syntax_error_encountered (instance method)">- (Object) <strong>syntax_error_encountered</strong>(ignored_chunk) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Called when our Ragel parser encounters some unexpected syntax from
Asterisk.
</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterface (class)">ManagerInterface</a></span></tt>) <strong>initialize</strong>(options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Creates a new Asterisk Manager Interface connection and exposes certain
methods to control it. The constructor takes named parameters as Symbols.
Note: if the :events option is given, this library will establish a
separate socket for just events. Two sockets are used because some actions
actually respond with events, making it very complicated to differentiate
between response-type events and normal events.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
Available options are :host, :port, :username, :password, and :events
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 108</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span><span class='id options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id options'>options</span> <span class='op'>=</span> <span class='id parse_options'>parse_options</span> <span class='id options'>options</span>
  <span class='ivar'>@host</span>           <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:host</span><span class='rbracket'>]</span>
  <span class='ivar'>@username</span>       <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:username</span><span class='rbracket'>]</span>
  <span class='ivar'>@password</span>       <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span>
  <span class='ivar'>@port</span>           <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:port</span><span class='rbracket'>]</span>
  <span class='ivar'>@events</span>         <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:events</span><span class='rbracket'>]</span>
  <span class='ivar'>@auto_reconnect</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:auto_reconnect</span><span class='rbracket'>]</span>
  <span class='ivar'>@event_callback</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:event_callback</span><span class='rbracket'>]</span>

  <span class='ivar'>@sent_messages</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@sent_messages_lock</span> <span class='op'>=</span> <span class='const'>Mutex</span><span class='period'>.</span><span class='id new'>new</span>

  <span class='ivar'>@actions_lexer</span> <span class='op'>=</span> <span class='const'>DelegatingAsteriskManagerInterfaceLexer</span><span class='period'>.</span><span class='id new'>new</span> <span class='kw'>self</span><span class='comma'>,</span> \
      <span class='symbol'>:message_received</span> <span class='op'>=&gt;</span> <span class='symbol'>:action_message_received</span><span class='comma'>,</span>
      <span class='symbol'>:error_received</span>   <span class='op'>=&gt;</span> <span class='symbol'>:action_error_received</span>

  <span class='ivar'>@write_queue</span> <span class='op'>=</span> <span class='const'>Queue</span><span class='period'>.</span><span class='id new'>new</span>

  <span class='kw'>if</span> <span class='ivar'>@events</span>
    <span class='ivar'>@events_lexer</span> <span class='op'>=</span> <span class='const'>DelegatingAsteriskManagerInterfaceLexer</span><span class='period'>.</span><span class='id new'>new</span> <span class='kw'>self</span><span class='comma'>,</span> \
        <span class='symbol'>:message_received</span> <span class='op'>=&gt;</span> <span class='symbol'>:event_message_received</span><span class='comma'>,</span>
        <span class='symbol'>:error_received</span>   <span class='op'>=&gt;</span> <span class='symbol'>:event_error_received</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="causal_event_terminator_name_for-class_method">
  
    + (<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>) <strong>causal_event_terminator_name_for</strong>(action_name) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Used to determine the event name for an action which has causal events.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>action_name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
The corresponding event name which signals the completion of the causal
event sequence.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 71</span>

<span class='kw'>def</span> <span class='id causal_event_terminator_name_for'>causal_event_terminator_name_for</span><span class='lparen'>(</span><span class='id action_name'>action_name</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id has_causal_events?'>has_causal_events?</span><span class='lparen'>(</span><span class='id action_name'>action_name</span><span class='rparen'>)</span>
  <span class='id action_name'>action_name</span> <span class='op'>=</span> <span class='id action_name'>action_name</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id downcase'>downcase</span>
   <span class='kw'>case</span> <span class='id action_name'>action_name</span>
     <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sippeers</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>iaxpeers</span><span class='tstring_end'>&quot;</span></span>
     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>peerlistcomplete</span><span class='tstring_end'>&quot;</span></span>
   <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dbget</span><span class='tstring_end'>&quot;</span></span>
     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dbgetresponse</span><span class='tstring_end'>&quot;</span></span>
   <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>konferencelist</span><span class='tstring_end'>&quot;</span></span>
     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>conferencelistcomplete</span><span class='tstring_end'>&quot;</span></span>
   <span class='kw'>else</span>
       <span class='id action_name'>action_name</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>complete</span><span class='tstring_end'>&quot;</span></span>
   <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="connect-class_method">
  
    + (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>connect</strong>(*args) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 38</span>

<span class='kw'>def</span> <span class='id connect'>connect</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='id new'>new</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span><span class='period'>.</span><span class='id tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id connection'>connection</span><span class='op'>|</span>
    <span class='id connection'>connection</span><span class='period'>.</span><span class='id connect!'>connect!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="has_causal_events?-class_method">
  
    + (<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>) <strong>has_causal_events?</strong>(name, headers = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
When sending an action with &#8220;causal events&#8221; (i.e. events which
must be collected to form a proper response), AMI should send a particular
event which instructs us that no more events will be sent. This event is
called the &#8220;causal event terminator&#8221;.
</p>
<p>
Note: you must supply both the name of the event and any headers because
it&#8217;s possible that some uses of an action (i.e. same name, different
headers) have causal events while other uses don&#8217;t.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the name of the event
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>the</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
headers associated with this event
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the downcase()&#8217;d name of the event name for which to wait
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 61</span>

<span class='kw'>def</span> <span class='id has_causal_events?'>has_causal_events?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id headers'>headers</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='const'>CAUSAL_EVENT_NAMES</span><span class='period'>.</span><span class='id include?'>include?</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id downcase'>downcase</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="replies_with_action_id?-class_method">
  
    + (<tt>Boolean</tt>) <strong>replies_with_action_id?</strong>(name, headers = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 44</span>

<span class='kw'>def</span> <span class='id replies_with_action_id?'>replies_with_action_id?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id headers'>headers</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id name'>name</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id downcase'>downcase</span>
  <span class='op'>!</span><span class='const'>UnsupportedActionName</span><span class='op'>::</span><span class='const'>UNSUPPORTED_ACTION_NAMES</span><span class='period'>.</span><span class='id include?'>include?</span> <span class='id name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="action_error_received-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>action_error_received</strong>(ami_error) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


191
192
193
194
195
196
197
198
199
200
201</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 191</span>

<span class='kw'>def</span> <span class='id action_error_received'>action_error_received</span><span class='lparen'>(</span><span class='id ami_error'>ami_error</span><span class='rparen'>)</span>
  <span class='id action_id'>action_id</span> <span class='op'>=</span> <span class='id ami_error'>ami_error</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ActionID</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>

  <span class='id corresponding_action'>corresponding_action</span> <span class='op'>=</span> <span class='id data_for_message_received_with_action_id'>data_for_message_received_with_action_id</span> <span class='id action_id'>action_id</span>

  <span class='kw'>if</span> <span class='id corresponding_action'>corresponding_action</span>
    <span class='id corresponding_action'>corresponding_action</span><span class='period'>.</span><span class='id future_resource'>future_resource</span><span class='period'>.</span><span class='id resource'>resource</span> <span class='op'>=</span> <span class='id ami_error'>ami_error</span>
  <span class='kw'>else</span>
    <span class='id ahn_log'>ahn_log</span><span class='period'>.</span><span class='id ami'>ami</span><span class='period'>.</span><span class='id error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Received an AMI error with an unrecognized ActionID!! This may be an bug! </span><span class='embexpr_beg'>#{</span><span class='id ami_error'>ami_error</span><span class='period'>.</span><span class='id inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="action_message_received-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>action_message_received</strong>(message) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 134</span>

<span class='kw'>def</span> <span class='id action_message_received'>action_message_received</span><span class='lparen'>(</span><span class='id message'>message</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id message'>message</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span> <span class='const'>Manager</span><span class='op'>::</span><span class='const'>ManagerInterfaceEvent</span>
    <span class='comment'># Trigger the return value of the waiting action id...
</span>    <span class='id corresponding_action'>corresponding_action</span>   <span class='op'>=</span> <span class='ivar'>@current_action_with_causal_events</span>
    <span class='id event_collection'>event_collection</span>       <span class='op'>=</span> <span class='ivar'>@event_collection_for_current_action</span>

    <span class='kw'>if</span> <span class='id corresponding_action'>corresponding_action</span>

      <span class='comment'># The &quot;DBGet&quot; command is causal, meaning it has an separate
</span>      <span class='comment'># event that contains the data for command's response.  However,
</span>      <span class='comment'># unlike other causal commands, AMI does not send a
</span>      <span class='comment'># &quot;DBGetComplete&quot; action indicating the causal event is
</span>      <span class='comment'># finished.  This is fixed starting in Asterisk 1.8.
</span>      <span class='kw'>if</span> <span class='id message'>message</span><span class='period'>.</span><span class='id name'>name</span><span class='period'>.</span><span class='id downcase'>downcase</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dbgetresponse</span><span class='tstring_end'>&quot;</span></span>
        <span class='id event_collection'>event_collection</span> <span class='op'>&lt;&lt;</span> <span class='id message'>message</span>
      <span class='kw'>end</span>

      <span class='comment'># If this is the meta-event which signals no more events will follow and the response is complete.
</span>      <span class='kw'>if</span> <span class='id message'>message</span><span class='period'>.</span><span class='id name'>name</span><span class='period'>.</span><span class='id downcase'>downcase</span> <span class='op'>==</span> <span class='id corresponding_action'>corresponding_action</span><span class='period'>.</span><span class='id causal_event_terminator_name'>causal_event_terminator_name</span>
        <span class='comment'># Wake up the waiting Thread
</span>        <span class='id corresponding_action'>corresponding_action</span><span class='period'>.</span><span class='id future_resource'>future_resource</span><span class='period'>.</span><span class='id resource'>resource</span> <span class='op'>=</span> <span class='id event_collection'>event_collection</span><span class='period'>.</span><span class='id freeze'>freeze</span>

        <span class='comment'># Clear the stored action and event collection
</span>        <span class='ivar'>@current_action_with_causal_events</span>   <span class='op'>=</span> <span class='kw'>nil</span>
        <span class='ivar'>@event_collection_for_current_action</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>else</span>
        <span class='id event_collection'>event_collection</span> <span class='op'>&lt;&lt;</span> <span class='id message'>message</span>
        <span class='comment'># We have more causal events coming.
</span>      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id ahn_log'>ahn_log</span><span class='period'>.</span><span class='id ami'>ami</span><span class='period'>.</span><span class='id error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Got an unexpected event on actions socket! This AMI command may have a multi-message response. Try making Adhearsion treat it as CAUSAL_EVENT </span><span class='embexpr_beg'>#{</span><span class='id message'>message</span><span class='period'>.</span><span class='id inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

  <span class='kw'>elsif</span> <span class='id message'>message</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ActionID</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id nil?'>nil?</span>
    <span class='comment'># No ActionID! Release the write lock and wake up the waiter
</span>  <span class='kw'>else</span>
    <span class='id action_id'>action_id</span> <span class='op'>=</span> <span class='id message'>message</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ActionID</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='id corresponding_action'>corresponding_action</span> <span class='op'>=</span> <span class='id data_for_message_received_with_action_id'>data_for_message_received_with_action_id</span> <span class='id action_id'>action_id</span>
    <span class='kw'>if</span> <span class='id corresponding_action'>corresponding_action</span>
      <span class='id message'>message</span><span class='period'>.</span><span class='id action'>action</span> <span class='op'>=</span> <span class='id corresponding_action'>corresponding_action</span>

      <span class='kw'>if</span> <span class='id corresponding_action'>corresponding_action</span><span class='period'>.</span><span class='id has_causal_events?'>has_causal_events?</span>
        <span class='comment'># By this point the write loop will already have started blocking by calling the response() method on the
</span>        <span class='comment'># action. Because we must collect more events before we wake the write loop up again, let's create these
</span>        <span class='comment'># instance variable which will needed when the subsequent causal events come in.
</span>        <span class='ivar'>@current_action_with_causal_events</span>   <span class='op'>=</span> <span class='id corresponding_action'>corresponding_action</span>
        <span class='ivar'>@event_collection_for_current_action</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='kw'>else</span>
        <span class='comment'># Wake any Threads waiting on the response.
</span>        <span class='id corresponding_action'>corresponding_action</span><span class='period'>.</span><span class='id future_resource'>future_resource</span><span class='period'>.</span><span class='id resource'>resource</span> <span class='op'>=</span> <span class='id message'>message</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id ahn_log'>ahn_log</span><span class='period'>.</span><span class='id ami'>ami</span><span class='period'>.</span><span class='id error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Received an AMI message with an unrecognized ActionID!! This may be an bug! </span><span class='embexpr_beg'>#{</span><span class='id message'>message</span><span class='period'>.</span><span class='id inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="actions_connection_disconnected-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>actions_connection_disconnected</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


243
244
245
246
247
248</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 243</span>

<span class='kw'>def</span> <span class='id actions_connection_disconnected'>actions_connection_disconnected</span>
  <span class='ivar'>@actions_state</span> <span class='op'>=</span> <span class='symbol'>:disconnected</span>
  <span class='id ahn_log'>ahn_log</span><span class='period'>.</span><span class='id ami'>ami</span><span class='period'>.</span><span class='id error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AMI connection for ACTION disconnected !!!</span><span class='tstring_end'>&quot;</span></span>
  <span class='id clear_actions_connection'>clear_actions_connection</span>
  <span class='id establish_actions_connection'>establish_actions_connection</span> <span class='kw'>if</span> <span class='ivar'>@auto_reconnect</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="actions_connection_established-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>actions_connection_established</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


238
239
240
241</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 238</span>

<span class='kw'>def</span> <span class='id actions_connection_established'>actions_connection_established</span>
  <span class='ivar'>@actions_state</span> <span class='op'>=</span> <span class='symbol'>:connected</span>
  <span class='id start_actions_writer_loop'>start_actions_writer_loop</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="call_and_exec-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>call_and_exec</strong>(channel, app, opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
call_and_exec allows you to make a call to a channel and then execute an
Astersik application on that call
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


383
384
385
386
387
388
389</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 383</span>

<span class='kw'>def</span> <span class='id call_and_exec'>call_and_exec</span><span class='lparen'>(</span><span class='id channel'>channel</span><span class='comma'>,</span> <span class='id app'>app</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id args'>args</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='symbol'>:channel</span> <span class='op'>=&gt;</span> <span class='id channel'>channel</span><span class='comma'>,</span> <span class='symbol'>:application</span> <span class='op'>=&gt;</span> <span class='id app'>app</span> <span class='rbrace'>}</span>
  <span class='id args'>args</span><span class='lbracket'>[</span><span class='symbol'>:caller_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:caller_id</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:caller_id</span><span class='rbracket'>]</span>
  <span class='id args'>args</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:args</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:args</span><span class='rbracket'>]</span>
  <span class='id args'>args</span><span class='lbracket'>[</span><span class='symbol'>:variables</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:variables</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:variables</span><span class='rbracket'>]</span>
  <span class='id originate'>originate</span> <span class='id args'>args</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="call_into_context-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>call_into_context</strong>(channel, context, options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
call_into_context is syntactic sugar for the Asterisk originate command
that allows you to launch a call into a particular context. For example:
</p>
<p>
call_into_context(&#8216;SIP/1000@sipnetworks.com&#8217;,
&#8216;my_context&#8217;, { :variables => { :session_guid => new_guid }})
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


395
396
397
398
399
400
401
402</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 395</span>

<span class='kw'>def</span> <span class='id call_into_context'>call_into_context</span><span class='lparen'>(</span><span class='id channel'>channel</span><span class='comma'>,</span> <span class='id context'>context</span><span class='comma'>,</span> <span class='id options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id args'>args</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='symbol'>:channel</span> <span class='op'>=&gt;</span> <span class='id channel'>channel</span><span class='comma'>,</span> <span class='symbol'>:context</span> <span class='op'>=&gt;</span> <span class='id context'>context</span><span class='rbrace'>}</span>
  <span class='id args'>args</span><span class='lbracket'>[</span><span class='symbol'>:priority</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:priority</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>1</span>
  <span class='id args'>args</span><span class='lbracket'>[</span><span class='symbol'>:exten</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:extension</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:extension</span><span class='rbracket'>]</span>
  <span class='id args'>args</span><span class='lbracket'>[</span><span class='symbol'>:caller_id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:caller_id</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:caller_id</span><span class='rbracket'>]</span>
  <span class='id args'>args</span><span class='lbracket'>[</span><span class='symbol'>:variables</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:variables</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:variables</span><span class='rbracket'>]</span>
  <span class='id originate'>originate</span> <span class='id args'>args</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="clear_actions_connection-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>clear_actions_connection</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


261
262
263
264
265</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 261</span>

<span class='kw'>def</span> <span class='id clear_actions_connection'>clear_actions_connection</span>
  <span class='id stop_actions_writer_loop'>stop_actions_writer_loop</span>
  <span class='id clear_actions_connection_resources'>clear_actions_connection_resources</span>
  <span class='id disconnect_actions_connection'>disconnect_actions_connection</span> <span class='kw'>if</span> <span class='ivar'>@actions_state</span><span class='period'>.</span><span class='id equal?'>equal?</span> <span class='symbol'>:connected</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="clear_events_connection-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>clear_events_connection</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


267
268
269</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 267</span>

<span class='kw'>def</span> <span class='id clear_events_connection'>clear_events_connection</span>
  <span class='id disconnect_events_connection'>disconnect_events_connection</span> <span class='kw'>if</span> <span class='ivar'>@events_state</span><span class='period'>.</span><span class='id equal?'>equal?</span> <span class='symbol'>:connected</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="connect!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>connect!</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Must be called after instantiation. Also see ManagerInterface::connect().
</p>


  </div>
</div>
<div class="tags">
  <h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ManagerInterface/AuthenticationFailedException.html" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterface::AuthenticationFailedException (class)">AuthenticationFailedException</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
if username or password are rejected
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234
235
236</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 232</span>

<span class='kw'>def</span> <span class='id connect!'>connect!</span>
  <span class='id establish_actions_connection'>establish_actions_connection</span>
  <span class='id establish_events_connection'>establish_events_connection</span> <span class='kw'>if</span> <span class='ivar'>@events</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="disconnect!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>disconnect!</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


271
272
273
274</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 271</span>

<span class='kw'>def</span> <span class='id disconnect!'>disconnect!</span>
  <span class='id clear_actions_connection'>clear_actions_connection</span>
  <span class='id clear_events_connection'>clear_events_connection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dynamic-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>dynamic</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


276
277
278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 276</span>

<span class='kw'>def</span> <span class='id dynamic'>dynamic</span>
  <span class='comment'># TODO: Return an object which responds to method_missing
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="event_error_received-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>event_error_received</strong>(message) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 212</span>

<span class='kw'>def</span> <span class='id event_error_received'>event_error_received</span><span class='lparen'>(</span><span class='id message'>message</span><span class='rparen'>)</span>
  <span class='comment'># Does this ever even occur?
</span>  <span class='id ahn_log'>ahn_log</span><span class='period'>.</span><span class='id ami'>ami</span><span class='period'>.</span><span class='id error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hmmm, got an error on the AMI events-only socket! This must be a bug! </span><span class='embexpr_beg'>#{</span><span class='id message'>message</span><span class='period'>.</span><span class='id inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="event_message_received-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>event_message_received</strong>(event) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Called only when this ManagerInterface is instantiated with events enabled.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208
209
210</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 206</span>

<span class='kw'>def</span> <span class='id event_message_received'>event_message_received</span><span class='lparen'>(</span><span class='id event'>event</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id event'>event</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>ManagerInterfaceResponse</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id event'>event</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Message</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Authentication accepted</span><span class='tstring_end'>&quot;</span></span>
  <span class='comment'># TODO: convert the event name to a certain namespace.
</span>  <span class='ivar'>@event_callback</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span><span class='id event'>event</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="events_connection_disconnected-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>events_connection_disconnected</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


254
255
256
257
258
259</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 254</span>

<span class='kw'>def</span> <span class='id events_connection_disconnected'>events_connection_disconnected</span>
  <span class='ivar'>@events_state</span> <span class='op'>=</span> <span class='symbol'>:disconnected</span>
  <span class='id ahn_log'>ahn_log</span><span class='period'>.</span><span class='id ami'>ami</span><span class='period'>.</span><span class='id error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AMI connection for EVENT disconnected !!!</span><span class='tstring_end'>&quot;</span></span>
  <span class='id clear_events_connection'>clear_events_connection</span>
  <span class='id establish_events_connection'>establish_events_connection</span> <span class='kw'>if</span> <span class='ivar'>@auto_reconnect</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="events_connection_established-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>events_connection_established</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


250
251
252</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 250</span>

<span class='kw'>def</span> <span class='id events_connection_established'>events_connection_established</span>
  <span class='ivar'>@events_state</span> <span class='op'>=</span> <span class='symbol'>:connected</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="hangup-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>hangup</strong>(channel) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
hangup terminates a call accepts a channel as the argument full details
here: <a
href="http://www.voip-info.org/wiki/index.php?page=Asterisk+Manager+API+Action+Hangup">www.voip-info.org/wiki/index.php?page=Asterisk+Manager+API+Action+Hangup</a>
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


377
378
379</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 377</span>

<span class='kw'>def</span> <span class='id hangup'>hangup</span><span class='lparen'>(</span><span class='id channel'>channel</span><span class='rparen'>)</span>
  <span class='id send_action'>send_action</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hangup</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:channel</span> <span class='op'>=&gt;</span> <span class='id channel'>channel</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="introduce-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>introduce</strong>(caller, callee, opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
An introduction connects two endpoints together. The first argument is the
first person the PBX will call. When she&#8217;s picked up, Asterisk will
play ringing while the second person is being dialed.
</p>
<p>
The first argument is the person called first. Pass this as a canonical
IAX2/server/user type argument. Destination takes the same format, but
comma-separated Dial() arguments can be optionally passed after the
technology.
</p>
<p>
TODO: Provide an example when this works.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


369
370
371
372
373</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 369</span>

<span class='kw'>def</span> <span class='id introduce'>introduce</span><span class='lparen'>(</span><span class='id caller'>caller</span><span class='comma'>,</span> <span class='id callee'>callee</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id dial_args'>dial_args</span>  <span class='op'>=</span> <span class='id callee'>callee</span>
  <span class='id dial_args'>dial_args</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>|</span><span class='embexpr_beg'>#{</span><span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:options</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:options</span><span class='rbracket'>]</span>
  <span class='id call_and_exec'>call_and_exec</span> <span class='id caller'>caller</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Dial</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:args</span> <span class='op'>=&gt;</span> <span class='id dial_args'>dial_args</span><span class='comma'>,</span> <span class='symbol'>:caller_id</span> <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:caller_id</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="originate-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>originate</strong>(options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
The originate method launches a call to Asterisk, full details here: <a
href="http://www.voip-info.org/tiki-index.php?page=Asterisk+Manager+API+Action+Originate">www.voip-info.org/tiki-index.php?page=Asterisk+Manager+API+Action+Originate</a>
Takes these arguments as a hash:
</p>
<pre class="code">
  Channel: Channel on which to originate the call (The same as you specify in the Dial application command)
  Context: Context to use on connect (must use Exten &amp; Priority with it)
  Exten: Extension to use on connect (must use Context &amp; Priority with it)
  Priority: Priority to use on connect (must use Context &amp; Exten with it)
  Timeout: Timeout (in milliseconds) for the originating connection to happen(defaults to 30000 milliseconds)
  CallerID: CallerID to use for the call
  Variable: Channels variables to set (max 32). Variables will be set for both channels (local and connected).
  Account: Account code for the call
  Application: Application to use on connect (use Data for parameters)
  Data : Data if Application parameter is used
  Async: For the origination to be asynchronous (allows multiple calls to be generated without waiting for a response)
  ActionID: The request identifier. It allows you to identify the response to this request.
  You may use a number or a string. Useful when you make several simultaneous requests.
</pre>
<p>
For example: originate { :channel  =>
&#8216;SIP/1000@sipnetworks.com&#8217;,
</p>
<pre class="code">
            :context  =&gt; 'my_context',
            :exten    =&gt; 's',
            :priority =&gt; '1' }</pre>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


348
349
350
351
352
353
354
355
356</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 348</span>

<span class='kw'>def</span> <span class='id originate'>originate</span><span class='lparen'>(</span><span class='id options'>options</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id options'>options</span> <span class='op'>=</span> <span class='id options'>options</span><span class='period'>.</span><span class='id clone'>clone</span>
  <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:callerid</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id options'>options</span><span class='period'>.</span><span class='id delete'>delete</span> <span class='symbol'>:caller_id</span> <span class='kw'>if</span> <span class='id options'>options</span><span class='period'>.</span><span class='id has_key?'>has_key?</span> <span class='symbol'>:caller_id</span>
  <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:exten</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id options'>options</span><span class='period'>.</span><span class='id delete'>delete</span> <span class='symbol'>:extension</span> <span class='kw'>if</span> <span class='id options'>options</span><span class='period'>.</span><span class='id has_key?'>has_key?</span> <span class='symbol'>:extension</span>
  <span class='kw'>if</span> <span class='id options'>options</span><span class='period'>.</span><span class='id has_key?'>has_key?</span><span class='lparen'>(</span><span class='symbol'>:variables</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:variables</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id options'>options</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:variables</span><span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id pair'>pair</span><span class='op'>|</span> <span class='id pair'>pair</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>=</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='ivar'>@coreSettings</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ArgumentDelimiter</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id send_action'>send_action</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Originate</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id options'>options</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ping-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>ping</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
ping sends an action to the Asterisk Manager Interface that returns a pong
more details here: <a
href="http://www.voip-info.org/wiki/index.php?page=Asterisk+Manager+API+Action+Ping">www.voip-info.org/wiki/index.php?page=Asterisk+Manager+API+Action+Ping</a>
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


320
321
322
323</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 320</span>

<span class='kw'>def</span> <span class='id ping'>ping</span>
  <span class='id send_action'>send_action</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Ping</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="send_action_asynchronously-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../FutureResource.html" title="FutureResource (class)">FutureResource</a></span></tt>) <strong>send_action_asynchronously</strong>(action_name, headers = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <div class="note deprecated"><strong>Deprecated.</strong> <div class='inline'><p>
Async AMI is deprecated
</p>
</div></div>
<p>
Used to directly send a new action to Asterisk. Note: NEVER supply an
ActionID; these are handled internally.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>action_name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>, <tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
The name of the action (e.g. Originate)
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>headers</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>
Other key/value pairs to send in this action. Note: don&#8217;t provide an
ActionID
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../FutureResource.html" title="FutureResource (class)">FutureResource</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Call resource() on this object if you wish to access the response
(optional). Note: if the response has not come in yet, your Thread will
wait until it does.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


288
289
290
291
292
293
294
295
296
297
298
299</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 288</span>

<span class='kw'>def</span> <span class='id send_action_asynchronously'>send_action_asynchronously</span><span class='lparen'>(</span><span class='id action_name'>action_name</span><span class='comma'>,</span> <span class='id headers'>headers</span><span class='op'>=</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id ahn_log'>ahn_log</span><span class='period'>.</span><span class='id ami'>ami</span><span class='period'>.</span><span class='id deprecation'>deprecation</span><span class='period'>.</span><span class='id warn'>warn</span>  <span class='heredoc_beg'>&lt;&lt;WARN</span>
<span class='tstring_content'>Asterisk only supports one outstanding action ID at a time, making the
asynchronous AMI interface dangerous to use.  This interface is now deprecated
and will disappear in future versions of Adhearsion.  If you need to do
background processing while Asterisk processes a long-running action (such as
a synchronous Originate) then you will need to handle this manually with
Ruby threads.  Note that Originate specifically has an :Async header which tells
Asterisk to process the Originate event asynchronously.
</span><span class='heredoc_end'>WARN
</span>  <span class='id _send_action_asynchronously'>_send_action_asynchronously</span><span class='lparen'>(</span><span class='id action_name'>action_name</span><span class='comma'>,</span> <span class='id headers'>headers</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="send_action_synchronously-instance_method">
  
    - (<tt><span class='object_link'><a href="ManagerInterfaceResponse.html" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterfaceResponse (class)">ManagerInterfaceResponse</a></span></tt>, <tt>ImmediateResponse</tt>) <strong>send_action_synchronously</strong>(*args) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='send_action-instance_method'>send_action</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
Sends an action over the AMI connection and blocks your Thread until the
response comes in. If there was an error for some reason, the error will be
raised as an ManagerInterfaceError.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>action_name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>, <tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
The name of the action (e.g. Originate)
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>headers</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Other key/value pairs to send in this action. Note: don&#8217;t provide an
ActionID
</p>
</div>
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ManagerInterfaceResponse.html" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterfaceResponse (class)">ManagerInterfaceResponse</a></span></tt>, <tt>ImmediateResponse</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
Contains the response from Asterisk and all headers
</p>
</div>
      
    </li>
  
</ul>
<h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ManagerInterfaceError.html" title="Adhearsion::VoIP::Asterisk::Manager::ManagerInterfaceError (class)">ManagerInterfaceError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
When Asterisk can&#8217;t execute this action, it sends back an Error which
is converted into an ManagerInterfaceError object and raised. Access
ManagerInterfaceError#message for the reported message from Asterisk.
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


310
311
312
313
314</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 310</span>

<span class='kw'>def</span> <span class='id send_action_synchronously'>send_action_synchronously</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span>
  <span class='id _send_action_asynchronously'>_send_action_asynchronously</span><span class='lparen'>(</span><span class='op'>*</span><span class='id args'>args</span><span class='rparen'>)</span><span class='period'>.</span><span class='id response'>response</span><span class='period'>.</span><span class='id tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id response'>response</span><span class='op'>|</span>
    <span class='id raise'>raise</span> <span class='id response'>response</span> <span class='kw'>if</span> <span class='id response'>response</span><span class='period'>.</span><span class='id kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>ManagerInterfaceError</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="syntax_error_encountered-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>syntax_error_encountered</strong>(ignored_chunk) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Called when our Ragel parser encounters some unexpected syntax from
Asterisk. Anytime this is called, it should be considered a bug in
Adhearsion. Note: this same method is called regardless of whether the
syntax error happened on the actions socket or on the events socket.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/adhearsion/voip/asterisk/manager_interface.rb', line 222</span>

<span class='kw'>def</span> <span class='id syntax_error_encountered'>syntax_error_encountered</span><span class='lparen'>(</span><span class='id ignored_chunk'>ignored_chunk</span><span class='rparen'>)</span>
  <span class='id ahn_log'>ahn_log</span><span class='period'>.</span><span class='id ami'>ami</span><span class='period'>.</span><span class='id error'>error</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ADHEARSION'S AMI PARSER ENCOUNTERED A SYNTAX ERROR! </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PLEASE REPORT THIS ON http://bugs.adhearsion.com! OFFENDING TEXT:\n</span><span class='embexpr_beg'>#{</span><span class='id ignored_chunk'>ignored_chunk</span><span class='period'>.</span><span class='id inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Mon Aug  8 16:22:08 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.2 (ruby-1.9.2).
</div>

  </body>
</html>